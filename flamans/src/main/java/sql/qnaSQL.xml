<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="flamans.qna">
	<select id="qna_List" resultType="flamans.qna.model.QnaDTO" parameterType="Map">
        select * 
        	from 
        (select rownum as rnum,a.* from 
        	(select * from fm_qna where qna_kind = #{qna_kind}
        	<if test="qna_item != '' and qna_item != null">
        		and qna_item = #{qna_item}
        	</if>
        	order by qna_idx desc)a)b<![CDATA[ 
		where rnum>=#{start} 
        	and 
        rnum<=#{end}
  	 ]]> 
	</select>
	
	<insert id="qna_Write" parameterType="flamans.qna.model.QnaDTO">
		insert
			into
		fm_qna
			values(#{qna_writer},
		#{qna_subject},
			#{qna_content},
		sysdate,
			#{qna_item},
		#{qna_pwd},
			#{qna_secret},
		#{qna_findname},
			0,0,0,0,
		fm_qna_idx.nextval,
			#{qna_kind})
	</insert>
	
	<select id="qna_Content" parameterType="int" resultType="flamans.qna.model.QnaDTO">
		select *
			from
		fm_qna
			where qna_idx=
		#{qna_idx}	
	</select>

	<update id="qna_Readnum" parameterType="int">
		update 
			fm_qna
		set 
			readnum=readnum+1 
		where qna_idx = 
			#{qna_idx}
	</update>
	
	<select id="qna_Total" parameterType="Map" resultType="int">
		select 
			count(*) 
		from 
			fm_qna 
		where qna_kind =
			#{qna_kind}
       	<if test="qna_item != '' and qna_item != null">
      		and qna_item = #{qna_item}
      	</if>
	</select>
	
	<update id="qna_Update" parameterType="flamans.qna.model.QnaDTO">
		update
			fm_qna
		set
			qna_subject = #{qna_subject},
		qna_content = #{qna_content},
			qna_writedate = sysdate,
		qna_item = #{qna_item},
			qna_pwd = #{qna_pwd},
		qna_secret = #{qna_secret},
			qna_findname = #{qna_findname}
		where qna_idx = 
			#{qna_idx}	
	</update>
	
	<select id="qna_Pwd" parameterType="int" resultType="String">
		select qna_pwd 
			from
		fm_qna
			where qna_idx =
		#{qna_idx}		
	</select>
</mapper>